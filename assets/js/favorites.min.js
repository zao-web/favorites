var Favorites;!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=t()}}(function(){return function a(i,s,c){function u(e,t){if(!s[e]){if(!i[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(f)return f(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[e]={exports:{}};i[e][0].call(r.exports,function(t){return u(i[e][1][t]||t)},r,r.exports,a,i,s,c)}return s[e].exports}for(var f="function"==typeof require&&require,t=0;t<c.length;t++)u(c[t]);return u}({1:[function(t,f,e){(function(e){"use strict";function o(){c=!0;for(var t,e,o=u.length;o;){for(e=u,u=[],t=-1;++t<o;)e[t]();o=u.length}c=!1}var n,t=e.MutationObserver||e.WebKitMutationObserver;if(t){var r=0,a=new t(o),i=e.document.createTextNode("");a.observe(i,{characterData:!0}),n=function(){i.data=r=++r%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){o(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(o,0)};else{var s=new e.MessageChannel;s.port1.onmessage=o,n=function(){s.port2.postMessage(0)}}var c,u=[];f.exports=function(t){1!==u.push(t)||c||n()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,o){"use strict";function u(){}function n(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,t!==u&&s(this,t)}function r(t,e,o){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof o&&(this.onRejected=o,this.callRejected=this.otherCallRejected)}function a(e,o,n){f(function(){var t;try{t=o(n)}catch(t){return l.reject(e,t)}t===e?l.reject(e,new TypeError("Cannot resolve promise with itself")):l.resolve(e,t)})}function i(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function s(e,t){function o(t){r||(r=!0,l.reject(e,t))}function n(t){r||(r=!0,l.resolve(e,t))}var r=!1,a=c(function(){t(n,o)});"error"===a.status&&o(a.value)}function c(t,e){var o={};try{o.value=t(e),o.status="success"}catch(t){o.status="error",o.value=t}return o}var f=t(1),l={},d=["REJECTED"],v=["FULFILLED"],p=["PENDING"];(e.exports=n).prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(t,e){if("function"!=typeof t&&this.state===v||"function"!=typeof e&&this.state===d)return this;var o=new this.constructor(u);return this.state!==p?a(o,this.state===v?t:e,this.outcome):this.queue.push(new r(o,t,e)),o},r.prototype.callFulfilled=function(t){l.resolve(this.promise,t)},r.prototype.otherCallFulfilled=function(t){a(this.promise,this.onFulfilled,t)},r.prototype.callRejected=function(t){l.reject(this.promise,t)},r.prototype.otherCallRejected=function(t){a(this.promise,this.onRejected,t)},l.resolve=function(t,e){var o=c(i,e);if("error"===o.status)return l.reject(t,o.value);var n=o.value;if(n)s(t,n);else{t.state=v,t.outcome=e;for(var r=-1,a=t.queue.length;++r<a;)t.queue[r].callFulfilled(e)}return t},l.reject=function(t,e){t.state=d,t.outcome=e;for(var o=-1,n=t.queue.length;++o<n;)t.queue[o].callRejected(e);return t},n.resolve=function(t){return t instanceof this?t:l.resolve(new this(u),t)},n.reject=function(t){var e=new this(u);return l.reject(e,t)},n.all=function(t){function e(t,e){o.resolve(t).then(function(t){a[e]=t,++i!==n||r||(r=!0,l.resolve(c,a))},function(t){r||(r=!0,l.reject(c,t))})}var o=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),i=0,s=-1,c=new this(u);++s<n;)e(t[s],s);return c},n.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var o,n=t.length,r=!1;if(!n)return this.resolve([]);for(var a=-1,i=new this(u);++a<n;)o=t[a],e.resolve(o).then(function(t){r||(r=!0,l.resolve(i,t))},function(t){r||(r=!0,l.reject(i,t))});return i}},{1:1}],3:[function(e,t,o){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,o){"use strict";function i(e,o){e=e||[],o=o||{};try{return new Blob(e,o)}catch(t){if("TypeError"!==t.name)throw t;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(o.type)}}function l(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function f(t,e,o){"function"==typeof e&&t.then(e),"function"==typeof o&&t.catch(o)}function d(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function a(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function n(t){return"boolean"==typeof A?k.resolve(A):function(n){return new k(function(o){var t=n.transaction(N,L),e=i([""]);t.objectStore(N).put(e,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),o(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);o(e||!t||43<=parseInt(t[1],10))}}).catch(function(){return!1})}(t).then(function(t){return A=t})}function s(t){var e=O[t.name],o={};o.promise=new k(function(t,e){o.resolve=t,o.reject=e}),e.deferredOperations.push(o),e.dbReady?e.dbReady=e.dbReady.then(function(){return o.promise}):e.dbReady=o.promise}function c(t){var e=O[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function u(t,e){var o=O[t.name].deferredOperations.pop();if(o)return o.reject(e),o.promise}function r(r,a){return new k(function(t,e){if(O[r.name]=O[r.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},r.db){if(!a)return t(r.db);s(r),r.db.close()}var o=[r.name];a&&o.push(r.version);var n=x.open.apply(x,o);a&&(n.onupgradeneeded=function(t){var e=n.result;try{e.createObjectStore(r.storeName),t.oldVersion<=1&&e.createObjectStore(N)}catch(e){if("ConstraintError"!==e.name)throw e;console.warn('The database "'+r.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+r.storeName+'" already exists.')}}),n.onerror=function(t){t.preventDefault(),e(n.error)},n.onsuccess=function(){t(n.result),c(r)}})}function v(t){return r(t,!1)}function p(t){return r(t,!0)}function h(t,e){if(!t.db)return!0;var o=!t.db.objectStoreNames.contains(t.storeName),n=t.version<t.db.version,r=t.version>t.db.version;if(n&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||o){if(o){var a=t.db.version+1;a>t.version&&(t.version=a)}return!0}return!1}function m(t){return i([function(t){for(var e=t.length,o=new ArrayBuffer(e),n=new Uint8Array(o),r=0;r<e;r++)n[r]=t.charCodeAt(r);return o}(atob(t.data))],{type:t.type})}function g(t){return t&&t.__local_forage_encoded_blob}function b(t){var e=this,o=e._initReady().then(function(){var t=O[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return f(o,t,t),o}function y(t,e,o,n){void 0===n&&(n=1);try{var r=t.db.transaction(t.storeName,e);o(null,r)}catch(r){if(0<n&&(!t.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return k.resolve().then(function(){if(!t.db||"NotFoundError"===r.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),p(t)}).then(function(){return function(o){s(o);for(var n=O[o.name],r=n.forages,t=0;t<r.length;t++){var e=r[t];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return o.db=null,v(o).then(function(t){return o.db=t,h(o)?p(o):t}).then(function(t){o.db=n.db=t;for(var e=0;e<r.length;e++)r[e]._dbInfo.db=t}).catch(function(t){throw u(o,t),t})}(t).then(function(){y(t,e,o,n-1)})}).catch(o);o(r)}}function _(t){var e,o,n,r,a,i=.75*t.length,s=t.length,c=0;"="===t[t.length-1]&&(i--,"="===t[t.length-2]&&i--);var u=new ArrayBuffer(i),f=new Uint8Array(u);for(e=0;e<s;e+=4)o=U.indexOf(t[e]),n=U.indexOf(t[e+1]),r=U.indexOf(t[e+2]),a=U.indexOf(t[e+3]),f[c++]=o<<2|n>>4,f[c++]=(15&n)<<4|r>>2,f[c++]=(3&r)<<6|63&a;return u}function F(t){var e,o=new Uint8Array(t),n="";for(e=0;e<o.length;e+=3)n+=U[o[e]>>2],n+=U[(3&o[e])<<4|o[e+1]>>4],n+=U[(15&o[e+1])<<2|o[e+2]>>6],n+=U[63&o[e+2]];return o.length%3==2?n=n.substring(0,n.length-1)+"=":o.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function w(t,e,o,n){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],o,n)}function I(t,n,r,a,i,s){t.executeSql(r,a,i,function(t,o){o.code===o.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(t,e){e.rows.length?s(t,o):w(t,n,function(){t.executeSql(r,a,i,s)},s)},s):s(t,o)},s)}function S(t,e){var o=t.name+"/";return t.storeName!==e.storeName&&(o+=t.storeName+"/"),o}function j(){return!function(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(t){return!0}}()||0<localStorage.length}function C(e,o){e[o]=function(){var t=arguments;return e.ready().then(function(){return e[o].apply(e,t)})}}function D(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];if(o)for(var n in o)o.hasOwnProperty(n)&&(V(o[n])?t[n]=o[n].slice():t[n]=o[n])}return t}var E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();"undefined"==typeof Promise&&t(3);function B(t,e){for(var o=t.length,n=0;n<o;){if((r=t[n])===(a=e)||"number"==typeof r&&"number"==typeof a&&isNaN(r)&&isNaN(a))return!0;n++}var r,a;return!1}var k=Promise,N="local-forage-detect-blob-support",A=void 0,O={},T=Object.prototype.toString,R="readonly",L="readwrite",M={_driver:"asyncStorage",_initStorage:function(t){function e(){return k.resolve()}var n=this,r={db:null};if(t)for(var o in t)r[o]=t[o];var a=O[r.name];a||(a={forages:[],db:null,dbReady:null,deferredOperations:[]},O[r.name]=a),a.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=b);for(var i=[],s=0;s<a.forages.length;s++){var c=a.forages[s];c!==n&&i.push(c._initReady().catch(e))}var u=a.forages.slice(0);return k.all(i).then(function(){return r.db=a.db,v(r)}).then(function(t){return r.db=t,h(r,n._defaultConfig.version)?p(r):t}).then(function(t){r.db=a.db=t,n._dbInfo=r;for(var e=0;e<u.length;e++){var o=u[e];o!==n&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})},_support:function(){try{if(!x)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(i,t){var s=this,e=new k(function(a,o){s.ready().then(function(){y(s._dbInfo,R,function(t,e){if(t)return o(t);try{var n=e.objectStore(s._dbInfo.storeName).openCursor(),r=1;n.onsuccess=function(){var t=n.result;if(t){var e=t.value;g(e)&&(e=m(e));var o=i(e,t.key,r++);void 0!==o?a(o):t.continue()}else a()},n.onerror=function(){o(n.error)}}catch(t){o(t)}})}).catch(o)});return l(e,t),e},getItem:function(a,t){var i=this;a=d(a);var e=new k(function(n,r){i.ready().then(function(){y(i._dbInfo,R,function(t,e){if(t)return r(t);try{var o=e.objectStore(i._dbInfo.storeName).get(a);o.onsuccess=function(){var t=o.result;void 0===t&&(t=null),g(t)&&(t=m(t)),n(t)},o.onerror=function(){r(o.error)}}catch(t){r(t)}})}).catch(r)});return l(e,t),e},setItem:function(s,e,t){var c=this;s=d(s);var o=new k(function(a,i){var t;c.ready().then(function(){return t=c._dbInfo,"[object Blob]"===T.call(e)?n(t.db).then(function(t){return t?e:function(n){return new k(function(o,t){var e=new FileReader;e.onerror=t,e.onloadend=function(t){var e=btoa(t.target.result||"");o({__local_forage_encoded_blob:!0,data:e,type:n.type})},e.readAsBinaryString(n)})}(e)}):e}).then(function(r){y(c._dbInfo,L,function(t,e){if(t)return i(t);try{var o=e.objectStore(c._dbInfo.storeName);null===r&&(r=void 0);var n=o.put(r,s);e.oncomplete=function(){void 0===r&&(r=null),a(r)},e.onabort=e.onerror=function(){var t=n.error?n.error:n.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return l(o,t),o},removeItem:function(a,t){var i=this;a=d(a);var e=new k(function(n,r){i.ready().then(function(){y(i._dbInfo,L,function(t,e){if(t)return r(t);try{var o=e.objectStore(i._dbInfo.storeName).delete(a);e.oncomplete=function(){n()},e.onerror=function(){r(o.error)},e.onabort=function(){var t=o.error?o.error:o.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return l(e,t),e},clear:function(t){var a=this,e=new k(function(n,r){a.ready().then(function(){y(a._dbInfo,L,function(t,e){if(t)return r(t);try{var o=e.objectStore(a._dbInfo.storeName).clear();e.oncomplete=function(){n()},e.onabort=e.onerror=function(){var t=o.error?o.error:o.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return l(e,t),e},length:function(t){var a=this,e=new k(function(n,r){a.ready().then(function(){y(a._dbInfo,R,function(t,e){if(t)return r(t);try{var o=e.objectStore(a._dbInfo.storeName).count();o.onsuccess=function(){n(o.result)},o.onerror=function(){r(o.error)}}catch(t){r(t)}})}).catch(r)});return l(e,t),e},key:function(s,t){var c=this,e=new k(function(a,i){s<0?a(null):c.ready().then(function(){y(c._dbInfo,R,function(t,e){if(t)return i(t);try{var o=e.objectStore(c._dbInfo.storeName),n=!1,r=o.openCursor();r.onsuccess=function(){var t=r.result;t?0===s?a(t.key):n?a(t.key):(n=!0,t.advance(s)):a(null)},r.onerror=function(){i(r.error)}}catch(t){i(t)}})}).catch(i)});return l(e,t),e},keys:function(t){var i=this,e=new k(function(r,a){i.ready().then(function(){y(i._dbInfo,R,function(t,e){if(t)return a(t);try{var o=e.objectStore(i._dbInfo.storeName).openCursor(),n=[];o.onsuccess=function(){var t=o.result;t?(n.push(t.key),t.continue()):r(n)},o.onerror=function(){a(o.error)}}catch(t){a(t)}})}).catch(a)});return l(e,t),e},dropInstance:function(i,t){t=a.apply(this,arguments);var e,o=this.config();if((i="function"!=typeof i&&i||{}).name||(i.name=i.name||o.name,i.storeName=i.storeName||o.storeName),i.name){var n=i.name===o.name&&this._dbInfo.db?k.resolve(this._dbInfo.db):v(i).then(function(t){var e=O[i.name],o=e.forages;e.db=t;for(var n=0;n<o.length;n++)o[n]._dbInfo.db=t;return t});e=i.storeName?n.then(function(t){if(t.objectStoreNames.contains(i.storeName)){var r=t.version+1;s(i);var n=O[i.name],a=n.forages;t.close();for(var e=0;e<a.length;e++){var o=a[e];o._dbInfo.db=null,o._dbInfo.version=r}return new k(function(e,o){var n=x.open(i.name,r);n.onerror=function(t){n.result.close(),o(t)},n.onupgradeneeded=function(){n.result.deleteObjectStore(i.storeName)},n.onsuccess=function(){var t=n.result;t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<a.length;e++){var o=a[e];o._dbInfo.db=t,c(o._dbInfo)}}).catch(function(t){throw(u(i,t)||k.resolve()).catch(function(){}),t})}}):n.then(function(t){s(i);var o=O[i.name],n=o.forages;t.close();for(var e=0;e<n.length;e++)n[e]._dbInfo.db=null;return new k(function(e,o){var n=x.deleteDatabase(i.name);n.onerror=n.onblocked=function(t){var e=n.result;e&&e.close(),o(t)},n.onsuccess=function(){var t=n.result;t&&t.close(),e(t)}}).then(function(t){o.db=t;for(var e=0;e<n.length;e++)c(n[e]._dbInfo)}).catch(function(t){throw(u(i,t)||k.resolve()).catch(function(){}),t})})}else e=k.reject("Invalid arguments");return l(e,t),e}},U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",q=/^~~local_forage_type~([^~]+)~/,P="__lfsc__:",z=P.length,Q="arbf",W="blob",G=z+Q.length,H=Object.prototype.toString,X={serialize:function(e,o){var t="";if(e&&(t=H.call(e)),e&&("[object ArrayBuffer]"===t||e.buffer&&"[object ArrayBuffer]"===H.call(e.buffer))){var n,r=P;e instanceof ArrayBuffer?(n=e,r+=Q):(n=e.buffer,"[object Int8Array]"===t?r+="si08":"[object Uint8Array]"===t?r+="ui08":"[object Uint8ClampedArray]"===t?r+="uic8":"[object Int16Array]"===t?r+="si16":"[object Uint16Array]"===t?r+="ur16":"[object Int32Array]"===t?r+="si32":"[object Uint32Array]"===t?r+="ui32":"[object Float32Array]"===t?r+="fl32":"[object Float64Array]"===t?r+="fl64":o(new Error("Failed to get type for BinaryArray"))),o(r+F(n))}else if("[object Blob]"===t){var a=new FileReader;a.onload=function(){var t="~~local_forage_type~"+e.type+"~"+F(this.result);o(P+W+t)},a.readAsArrayBuffer(e)}else try{o(JSON.stringify(e))}catch(t){console.error("Couldn't convert value into a JSON string: ",e),o(null,t)}},deserialize:function(t){if(t.substring(0,z)!==P)return JSON.parse(t);var e,o=t.substring(G),n=t.substring(z,G);if(n===W&&q.test(o)){var r=o.match(q);e=r[1],o=o.substring(r[0].length)}var a=_(o);switch(n){case Q:return a;case W:return i([a],{type:e});case"si08":return new Int8Array(a);case"ui08":return new Uint8Array(a);case"uic8":return new Uint8ClampedArray(a);case"si16":return new Int16Array(a);case"ur16":return new Uint16Array(a);case"si32":return new Int32Array(a);case"ui32":return new Uint32Array(a);case"fl32":return new Float32Array(a);case"fl64":return new Float64Array(a);default:throw new Error("Unkown type: "+n)}},stringToBuffer:_,bufferToString:F},K={_driver:"webSQLStorage",_initStorage:function(t){var n=this,r={db:null};if(t)for(var e in t)r[e]="string"!=typeof t[e]?t[e].toString():t[e];var o=new k(function(e,o){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return o(e)}r.db.transaction(function(t){w(t,r,function(){n._dbInfo=r,e()},function(t,e){o(e)})},o)});return r.serializer=X,o},_support:"function"==typeof openDatabase,iterate:function(u,t){var e=this,o=new k(function(c,o){e.ready().then(function(){var s=e._dbInfo;s.db.transaction(function(t){I(t,s,"SELECT * FROM "+s.storeName,[],function(t,e){for(var o=e.rows,n=o.length,r=0;r<n;r++){var a=o.item(r),i=a.value;if(i=i&&s.serializer.deserialize(i),void 0!==(i=u(i,a.key,r+1)))return void c(i)}c()},function(t,e){o(e)})})}).catch(o)});return l(o,t),o},getItem:function(e,t){var a=this;e=d(e);var o=new k(function(r,o){a.ready().then(function(){var n=a._dbInfo;n.db.transaction(function(t){I(t,n,"SELECT * FROM "+n.storeName+" WHERE key = ? LIMIT 1",[e],function(t,e){var o=e.rows.length?e.rows.item(0).value:null;o=o&&n.serializer.deserialize(o),r(o)},function(t,e){o(e)})})}).catch(o)});return l(o,t),o},setItem:function(t,e,o){return function i(s,t,c,u){var f=this;s=d(s);var e=new k(function(r,a){f.ready().then(function(){void 0===t&&(t=null);var o=t,n=f._dbInfo;n.serializer.serialize(t,function(e,t){t?a(t):n.db.transaction(function(t){I(t,n,"INSERT OR REPLACE INTO "+n.storeName+" (key, value) VALUES (?, ?)",[s,e],function(){r(o)},function(t,e){a(e)})},function(t){if(t.code===t.QUOTA_ERR){if(0<u)return void r(i.apply(f,[s,o,c,u-1]));a(t)}})})}).catch(a)});return l(e,c),e}.apply(this,[t,e,o,1])},removeItem:function(r,t){var a=this;r=d(r);var e=new k(function(o,n){a.ready().then(function(){var e=a._dbInfo;e.db.transaction(function(t){I(t,e,"DELETE FROM "+e.storeName+" WHERE key = ?",[r],function(){o()},function(t,e){n(e)})})}).catch(n)});return l(e,t),e},clear:function(t){var r=this,e=new k(function(o,n){r.ready().then(function(){var e=r._dbInfo;e.db.transaction(function(t){I(t,e,"DELETE FROM "+e.storeName,[],function(){o()},function(t,e){n(e)})})}).catch(n)});return l(e,t),e},length:function(t){var r=this,e=new k(function(n,o){r.ready().then(function(){var e=r._dbInfo;e.db.transaction(function(t){I(t,e,"SELECT COUNT(key) as c FROM "+e.storeName,[],function(t,e){var o=e.rows.item(0).c;n(o)},function(t,e){o(e)})})}).catch(o)});return l(e,t),e},key:function(r,t){var a=this,e=new k(function(n,o){a.ready().then(function(){var e=a._dbInfo;e.db.transaction(function(t){I(t,e,"SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[r+1],function(t,e){var o=e.rows.length?e.rows.item(0).key:null;n(o)},function(t,e){o(e)})})}).catch(o)});return l(e,t),e},keys:function(t){var n=this,e=new k(function(r,o){n.ready().then(function(){var e=n._dbInfo;e.db.transaction(function(t){I(t,e,"SELECT key FROM "+e.storeName,[],function(t,e){for(var o=[],n=0;n<e.rows.length;n++)o.push(e.rows.item(n).key);r(o)},function(t,e){o(e)})})}).catch(o)});return l(e,t),e},dropInstance:function(o,t){t=a.apply(this,arguments);var n=this.config();(o="function"!=typeof o&&o||{}).name||(o.name=o.name||n.name,o.storeName=o.storeName||n.storeName);var e,r=this;return l(e=o.name?new k(function(t){var e;e=o.name===n.name?r._dbInfo.db:openDatabase(o.name,"","",0),t(o.storeName?{db:e,storeNames:[o.storeName]}:function(a){return new k(function(r,o){a.transaction(function(t){t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(t,e){for(var o=[],n=0;n<e.rows.length;n++)o.push(e.rows.item(n).name);r({db:a,storeNames:o})},function(t,e){o(e)})},function(t){o(t)})})}(e))}).then(function(s){return new k(function(a,i){s.db.transaction(function(n){function t(e){return new k(function(t,o){n.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(t,e){o(e)})})}for(var e=[],o=0,r=s.storeNames.length;o<r;o++)e.push(t(s.storeNames[o]));k.all(e).then(function(){a()}).catch(function(t){i(t)})},function(t){i(t)})})}):k.reject("Invalid arguments"),t),e}},J={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var o in t)e[o]=t[o];return e.keyPrefix=S(t,this._defaultConfig),j()?((this._dbInfo=e).serializer=X,k.resolve()):k.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(c,t){var u=this,e=u.ready().then(function(){for(var t=u._dbInfo,e=t.keyPrefix,o=e.length,n=localStorage.length,r=1,a=0;a<n;a++){var i=localStorage.key(a);if(0===i.indexOf(e)){var s=localStorage.getItem(i);if(s=s&&t.serializer.deserialize(s),void 0!==(s=c(s,i.substring(o),r++)))return s}}});return l(e,t),e},getItem:function(o,t){var n=this;o=d(o);var e=n.ready().then(function(){var t=n._dbInfo,e=localStorage.getItem(t.keyPrefix+o);return e=e&&t.serializer.deserialize(e)});return l(e,t),e},setItem:function(i,t,e){var s=this;i=d(i);var o=s.ready().then(function(){void 0===t&&(t=null);var a=t;return new k(function(o,n){var r=s._dbInfo;r.serializer.serialize(t,function(t,e){if(e)n(e);else try{localStorage.setItem(r.keyPrefix+i,t),o(a)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||n(t),n(t)}})})});return l(o,e),o},removeItem:function(e,t){var o=this;e=d(e);var n=o.ready().then(function(){var t=o._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return l(n,t),n},clear:function(t){var n=this,e=n.ready().then(function(){for(var t=n._dbInfo.keyPrefix,e=localStorage.length-1;0<=e;e--){var o=localStorage.key(e);0===o.indexOf(t)&&localStorage.removeItem(o)}});return l(e,t),e},length:function(t){var e=this.keys().then(function(t){return t.length});return l(e,t),e},key:function(o,t){var n=this,e=n.ready().then(function(){var e,t=n._dbInfo;try{e=localStorage.key(o)}catch(t){e=null}return e=e&&e.substring(t.keyPrefix.length)});return l(e,t),e},keys:function(t){var a=this,e=a.ready().then(function(){for(var t=a._dbInfo,e=localStorage.length,o=[],n=0;n<e;n++){var r=localStorage.key(n);0===r.indexOf(t.keyPrefix)&&o.push(r.substring(t.keyPrefix.length))}return o});return l(e,t),e},dropInstance:function(e,t){if(t=a.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var o=this.config();e.name=e.name||o.name,e.storeName=e.storeName||o.storeName}var n,r=this;return l(n=e.name?new k(function(t){t(e.storeName?S(e,r._defaultConfig):e.name+"/")}).then(function(t){for(var e=localStorage.length-1;0<=e;e--){var o=localStorage.key(e);0===o.indexOf(t)&&localStorage.removeItem(o)}}):k.reject("Invalid arguments"),t),n}},V=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Y={},Z={},$={INDEXEDDB:M,WEBSQL:K,LOCALSTORAGE:J},tt=[$.INDEXEDDB._driver,$.WEBSQL._driver,$.LOCALSTORAGE._driver],et=["dropInstance"],ot=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(et),nt={description:"",driver:tt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},rt=new(at.prototype.config=function(t){if("object"!==(void 0===t?"undefined":E(t)))return"string"==typeof t?this._config[t]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)},at.prototype.defineDriver=function(u,t,e){var o=new k(function(e,o){try{var n=u._driver,t=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!u._driver)return void o(t);for(var r=ot.concat("_initStorage"),a=0,i=r.length;a<i;a++){var s=r[a];if((!B(et,s)||u[s])&&"function"!=typeof u[s])return void o(t)}!function(){for(var t=function(o){return function(){var t=new Error("Method "+o+" is not implemented by the current driver"),e=k.reject(t);return l(e,arguments[arguments.length-1]),e}},e=0,o=et.length;e<o;e++){var n=et[e];u[n]||(u[n]=t(n))}}();var c=function(t){Y[n]&&console.info("Redefining LocalForage driver: "+n),Y[n]=u,Z[n]=t,e()};"_support"in u?u._support&&"function"==typeof u._support?u._support().then(c,o):c(!!u._support):c(!0)}catch(t){o(t)}});return f(o,t,e),o},at.prototype.driver=function(){return this._driver||null},at.prototype.getDriver=function(t,e,o){var n=Y[t]?k.resolve(Y[t]):k.reject(new Error("Driver not found."));return f(n,e,o),n},at.prototype.getSerializer=function(t){var e=k.resolve(X);return f(e,t),e},at.prototype.ready=function(t){var e=this,o=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return f(o,t,t),o},at.prototype.setDriver=function(t,e,o){function a(){s._config.driver=s.driver()}function i(t){return s._extend(t),a(),s._ready=s._initStorage(s._config),s._ready}function n(r){return function(){var n=0;return function t(){for(;n<r.length;){var e=r[n];return n++,s._dbInfo=null,s._ready=null,s.getDriver(e).then(i).catch(t)}a();var o=new Error("No available storage method found.");return s._driverSet=k.reject(o),s._driverSet}()}}var s=this;V(t)||(t=[t]);var r=this._getSupportedDrivers(t),c=null!==this._driverSet?this._driverSet.catch(function(){return k.resolve()}):k.resolve();return this._driverSet=c.then(function(){var t=r[0];return s._dbInfo=null,s._ready=null,s.getDriver(t).then(function(t){s._driver=t._driver,a(),s._wrapLibraryMethodsWithReady(),s._initDriver=n(r)})}).catch(function(){a();var t=new Error("No available storage method found.");return s._driverSet=k.reject(t),s._driverSet}),f(this._driverSet,e,o),this._driverSet},at.prototype.supports=function(t){return!!Z[t]},at.prototype._extend=function(t){D(this,t)},at.prototype._getSupportedDrivers=function(t){for(var e=[],o=0,n=t.length;o<n;o++){var r=t[o];this.supports(r)&&e.push(r)}return e},at.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ot.length;t<e;t++)C(this,ot[t])},at.prototype.createInstance=function(t){return new at(t)},at);function at(t){for(var e in!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,at),$)if($.hasOwnProperty(e)){var o=$[e],n=o._driver;this[e]=n,Y[n]||this.defineDriver(o)}this._defaultConfig=D({},nt),this._config=D({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}e.exports=rt},{3:3}]},{},[4])(4)}),(Favorites=Favorites||{}).Utilities=function(){var e=jQuery;this.isFavorite=function(o,t){var n=!1;return e.each(t,function(t,e){e&&e.hasOwnProperty("post_id")&&parseInt(e.post_id)===parseInt(o)&&(n=!0)}),n},this.objectLength=function(t){var e,o=0;for(e in t)t.hasOwnProperty(e)&&o++;return o},this.siteIndex=function(t,e){for(var o=0;o<e.length;o++)if(parseInt(e[o].site_id)===parseInt(t))return o},this.getThumbnail=function(t,e){var o=t.thumbnails;if(void 0===o||0==o.length)return!1;var n=o[e];return void 0!==n&&(n||!1)}},(Favorites=Favorites||{}).Formatter=function(){var a=jQuery;this.addFavoriteCount=function(t,e){return Favorites.jsData.button_options.include_count?(e<=0&&(e=0),t+=' <span class="simplefavorite-button-count">'+e+"</span>"):t},this.decrementAllCounts=function(){for(var t=a(".simplefavorite-button.active.has-count"),e=0;e<t.length;e++){var o=a(t)[e],n=a(o).find(".simplefavorite-button-count"),r=a(n).text()-1;a(o).attr("data-favoritecount",r)}}},(Favorites=Favorites||{}).ButtonOptionsFormatter=function(){var a=this,i=jQuery;a.options=Favorites.jsData.button_options,a.formatter=new Favorites.Formatter,a.format=function(t,e){a.options.custom_colors&&a.colors(t,e),a.html(t,e)},a.html=function(t,e){var o=i(t).attr("data-favoritecount"),n=a.options.button_type,r="";return"custom"===a.options.button_type?(e&&i(t).html(a.formatter.addFavoriteCount(Favorites.jsData.favorited,o)),e||i(t).html(a.formatter.addFavoriteCount(Favorites.jsData.favorite,o)),a.applyIconColor(t,e),void a.applyCountColor(t,e)):e?(r+='<i class="'+n.icon_class+'"></i> ',r+=n.state_active,void i(t).html(a.formatter.addFavoriteCount(r,o))):(r+='<i class="'+n.icon_class+'"></i> ',r+=n.state_default,i(t).html(a.formatter.addFavoriteCount(r,o)),a.applyIconColor(t,e),void a.applyCountColor(t,e))},a.colors=function(t,e){if(a.options.custom_colors){var o;if(e)return(o=a.options.active).background_active&&i(t).css("background-color",o.background_active),o.border_active&&i(t).css("border-color",o.border_active),void(o.text_active&&i(t).css("color",o.text_active));(o=a.options.default).background_default&&i(t).css("background-color",o.background_default),o.border_default&&i(t).css("border-color",o.border_default),o.text_default&&i(t).css("color",o.text_default),a.boxShadow(t)}},a.boxShadow=function(t){a.options.box_shadow||(i(t).css("box-shadow","none"),i(t).css("-webkit-box-shadow","none"),i(t).css("-moz-box-shadow","none"))},a.applyIconColor=function(t,e){a.options.custom_colors&&(e&&a.options.active.icon_active&&i(t).find("i").css("color",a.options.active.icon_active),!e&&a.options.default.icon_default&&i(t).find("i").css("color",a.options.default.icon_default))},a.applyCountColor=function(t,e){a.options.custom_colors&&(e&&a.options.active.count_active?i(t).find(Favorites.selectors.count).css("color",a.options.active.count_active):!e&&a.options.default.count_default&&i(t).find(Favorites.selectors.count).css("color",a.options.default.count_default))}},(Favorites=Favorites||{}).UserFavorites=function(){var r=this,a=jQuery;return r.initialLoad=!1,r.bindEvents=function(){a(window).on("load",function(){r.initialLoad=!0,r.getFavorites()})},r.getFavoritesFromServer=function(e){return a.get({url:Favorites.jsData.api_endpoints.user_favorites,datatype:"json",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",favorites_data.restNonce)},success:function(t){Favorites.store.setItem("userFavorites",t).then(function(t){Favorites.userFavorites=t,Favorites.jsData.dev_mode&&console.log(t),e||(a(document).trigger("favorites-user-favorites-loaded",[t,r.initialLoad]),a(document).trigger("favorites-update-all-buttons"))}).catch(function(t){})},error:function(t){Favorites.jsData.dev_mode&&(console.log("The was an error loading the user favorites."),console.log(t))}})},r.getFavorites=function(e){if(Favorites.jsData.maybeGetUserFavorites)return Favorites.store.getItem("userFavorites").then(function(t){return null!==t?(Favorites.userFavorites=t,e||(a(document).trigger("favorites-user-favorites-loaded",[Favorites.userFavorites,r.initialLoad]),a(document).trigger("favorites-update-all-buttons")),t):r.getFavoritesFromServer(e)}).catch(function(t){return console.log(t),r.getFavoritesFromServer(e)})},r.addFavorite=function(o){var t=r.getFavorites();console.log(o);var n=o.post_id;r.loading(!0,n),t.then(function(e){var t;e[0].groups.length||(e[0].groups[0]={posts:[]}),-1===e[0].groups[0].posts.indexOf(n)&&e[0].groups[0].posts.push(n),Favorites.removalCache.hasOwnProperty(n)?(t=Favorites.removalCache[o.post_id],delete Favorites.removalCache[o.post_id]):t={button:'<button class="simplefavorite-button active" data-postid="'+n+'" data-siteid="'+o.site_id+'" data-groupid="1"><span class="fas fa-heart"></span> <span class="favorite-text">Recipe Saved</span></button>',excerpt:"",post_id:n,post_type:"post",thumbnail:a(".wprm-recipe-image").html(),link:window.location.href.replace(window.location.hash,""),quick_easy:a(".category-quick-and-easy").length,title:a("h1.entry-title").text(),total:1},e[0].posts[n]=t,a.isArray(e[0].posts)&&(e[0].posts=e[0].posts.reduce(function(t,e,o){return t[n]=e,t},{})),console.error("favorites added to data store"),console.error(e),Favorites.store.setItem("userFavorites",e).then(function(){Favorites.userFavorites=e,a(document).trigger("favorites-updated-single",[e,n,o.site_id,o.status]),a(document).trigger("favorites-update-all-buttons"),r.loading(!1,n)}).catch(function(t){console.log("could not save favorite"),console.log(t),console.log(e)})})},r.loading=function(t,e){var o=a('button[data-postid="'+e+'"]');a.each(o,function(){a(this).attr("disabled",t),a(this).toggleClass(Favorites.cssClasses.loading,t),t&&a(this).html(r.addLoadingIndication())})},r.addLoadingIndication=function(t){return"1"!==Favorites.jsData.indicate_loading?t:"active"===r.data.status?Favorites.jsData.loading_text+Favorites.jsData.loading_image_active:Favorites.jsData.loading_text+Favorites.jsData.loading_image},r.removeFavorite=function(o){r.loading(!0,o.post_id),r.getFavorites().then(function(e){Favorites.removalCache.hasOwnProperty(o.post_id)||(Favorites.removalCache[o.post_id]=e[0].posts[o.post_id]),e[0].groups[0].posts=e[0].groups[0].posts.filter(function(t){return t!==o.post_id}),delete e[0].posts[o.post_id],Favorites.store.setItem("userFavorites",e).then(function(){Favorites.userFavorites=e,a(document).trigger("favorites-updated-single",[e,o.post_id,o.site_id,o.status]),a(document).trigger("favorites-update-all-buttons"),r.loading(!1,o.post_id)}).catch(function(t){console.log("could not remove favorite"),console.log(t),console.log(e)})})},r.bindEvents(),r},(Favorites=Favorites||{}).Sync=function(){var a=this;a.timeToSync=!1,a.deltaCheckInterval=1e4,a.timeoutInterval=1e4;var n=jQuery;return a.bindEvents=function(){Favorites.jsData.logged_in.length?(n(window).on("load",function(){0<n("div#wp-user-favorites").length&&a.loadPostsOnDashboard()}),n(document).on("favorites-login",function(){a.maybeSyncServer(),a.setDelta()}),a.checkIfLoggingIn(),n(".page-template-page_myrt .facetwp-checkbox").click(a.filterList),n(document).on("favorites-debounced-sync",function(){a.maybeSyncServer()}),n(document).on("favorites-synced",function(){a.setDelta()}),setInterval(function(){n(document).trigger("favorites-debounced-sync")},a.timeoutInterval),n('a[href*="action=logout"]').click(function(t){t.preventDefault();var e=this.href;return a.maybeSyncServer().then(function(){Favorites.store.clear().then(function(){window.location=e})}),!1})):Favorites.store.length().then(function(t){0<t&&Favorites.store.clear()})},a.checkIfLoggingIn=function(){n("#wp-user-favorites").length<1||a.getDelta().then(function(t){null===t&&n(document).trigger("favorites-login")})},a.maybeSyncServer=function(){return console.log("Maybe sync up with the server"),a.checkDelta().then(function(t){return t?Favorites.UserFavorites().getFavorites(!0).then(function(t){return t[0].posts,n.post({url:Favorites.jsData.api_endpoints.user_favorites,datatype:"json",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",favorites_data.restNonce)},data:{favorites:t},success:function(t){n(document).trigger("favorites-synced")},error:function(t){Favorites.jsData.dev_mode&&(console.log("The was an error loading the user favorites."),console.log(t))}})}):(console.log("Too SOON or no changes"),console.log(a.timeToSync),console.log("Too soon or no CHANGES"),console.log(a.hasChanges),!1)})},a.setDelta=function(){Favorites.UserFavorites().getFavorites().then(function(t){var e=Object.keys(t[0].posts);return console.log("setting the delta"),Favorites.store.setItem("userFavoritesFromServer",e).then(function(t){console.log(t);var e=(new Date).getTime();return Favorites.store.setItem("userFavoritesLastSyncTime",e),t})})},a.getDelta=function(){return Favorites.store.getItem("userFavoritesFromServer").then(function(t){return t})},a.arraysEqual=function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var o=0;o<t.length;++o)if(t[o]!==e[o])return!1;return!0},a.checkDelta=function(){var e=a.getDelta(),t=Favorites.UserFavorites().getFavorites(),n=Favorites.store.getItem("userFavoritesLastSyncTime",function(t){return t}),r=(new Date).getTime();return console.log("checking the delta"),t.then(function(o){return n.then(function(t){return r>t+a.deltaCheckInterval&&(a.timeToSync=!0),e.then(function(t){if(null===t)return!0;var e=!a.arraysEqual(Object.keys(o[0].posts),t);return a.hasChanges=e,a.hasChanges&&a.timeToSync})})})},a.removeLocalData=function(){return Favorites.store.removeItem("userFavorites").then(function(){return Favorites.store.removeItem("userFavoritesFromServer",function(){return Favorites.store.removeItem("userFavoritesLastSyncTime",timestamp)})})},a.loadPostsOnDashboard=function(){var e=wp.template("favorites-post"),o=n("div#wp-user-favorites .list");Favorites.UserFavorites().getFavorites().then(function(t){if(console.log(t),!t[0].groups.length||t[0].groups.length&&!t[0].groups[0].posts.length)return n("div#wp-user-favorites .list, div#wp-user-favorites .pagination").remove(),void n("div#wp-user-favorites").append("<p>You don't have any saved recipes yet! Click the <strong>floating heart</strong> or <strong>Save Recipe</strong> buttons on a recipe post and it will appear right here.</p><p><a style='color:#f4796c' href='"+window.location.origin+"'>Go to the RecipeTin Eats home page.</a></p>");Object.values(t[0].posts).forEach(function(t){n(".loading-favorite",o).length&&n(".loading-favorite",o).first().remove(),console.log(t),o.append(e(t))}),n(".loading-favorite",o).remove(),a.favoriteList=new List("wp-user-favorites",{valueNames:["entry-title-link",{data:["quick-easy"]}],page:20,pagination:!0}),a.favoriteList.sort("entry-title-link",{order:"asc"}),a.favoriteList.on("updated",function(){window.scrollTo(0,0)})})},a.filterList=function(){var e=!n(".page-template-page_myrt .facetwp-checkbox").hasClass("checked");console.log(e),a.favoriteList.filter(function(t){return console.log(t),console.log(e),!e||(console.log(t.values()),0<parseInt(t.values()["quick-easy"]))}),a.favoriteList.update()},a.bindEvents()},(Favorites=Favorites||{}).Clear=function(){var r=this,a=jQuery;return r.activeButton,r.utilities=new Favorites.Utilities,r.formatter=new Favorites.Formatter,r.bindEvents=function(){a(document).on("click",Favorites.selectors.clear_button,function(t){t.preventDefault(),r.activeButton=a(this),r.clearFavorites()}),a(document).on("favorites-updated-single",function(){r.updateClearButtons()}),a(document).one("favorites-user-favorites-loaded",function(){r.updateClearButtons()})},r.clearFavorites=function(){r.loading(!0);var e=a(r.activeButton).attr("data-siteid");a.ajax({url:Favorites.jsData.ajaxurl,type:"post",datatype:"json",data:{action:Favorites.formActions.clearall,siteid:e},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully cleared."),console.log(t)),Favorites.userFavorites=t.favorites,r.formatter.decrementAllCounts(),r.loading(!1),r.clearSiteFavorites(e),a(document).trigger("favorites-cleared",[r.activeButton,t.old_favorites]),a(document).trigger("favorites-update-all-buttons")},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error clearing the favorites list."),console.log(t))}})},r.loading=function(t){if(t)return a(r.activeButton).addClass(Favorites.cssClasses.loading),void a(r.activeButton).attr("disabled","disabled");a(r.activeButton).removeClass(Favorites.cssClasses.loading)},r.updateClearButtons=function(){for(var t,e,o=0;o<a(Favorites.selectors.clear_button).length;o++){t=a(Favorites.selectors.clear_button)[o],e=a(t).attr("data-siteid");for(var n=0;n<Favorites.userFavorites.length;n++)Favorites.userFavorites[n].site_id===parseInt(e)&&(0<r.utilities.objectLength(Favorites.userFavorites[n].posts)?a(t).attr("disabled",!1):a(t).attr("disabled","disabled"))}},r.clearSiteFavorites=function(o){a.each(Favorites.userFavorites,function(t,e){this.site_id===parseInt(o)&&(Favorites.userFavorites[t].posts={})})},r.bindEvents()},(Favorites=Favorites||{}).Lists=function(){var f=this,l=jQuery;return f.utilities=new Favorites.Utilities,f.buttonFormatter=new Favorites.ButtonOptionsFormatter,f.bindEvents=function(){l(document).on("favorites-update-all-lists",function(){f.updateAllLists()}),l(document).on("favorites-updated-single",function(){f.updateAllLists()}),l(document).on("favorites-cleared",function(){f.updateAllLists()}),l(document).one("favorites-user-favorites-loaded",function(){f.updateAllLists()})},f.updateAllLists=function(){if(void 0!==Favorites.userFavorites)for(var t=0;t<Favorites.userFavorites.length;t++)for(var e=l(Favorites.selectors.list+'[data-siteid="'+Favorites.userFavorites[t].site_id+'"]'),o=0;o<l(e).length;o++){var n=l(e)[o];f.updateSingleList(n)}},f.updateSingleList=function(o){var t=l(o).attr("data-userid"),e=l(o).attr("data-siteid"),n=l(o).attr("data-includelinks"),r=l(o).attr("data-includebuttons"),a=l(o).attr("data-includethumbnails"),i=l(o).attr("data-thumbnailsize"),s=l(o).attr("data-includeexcerpts"),c=l(o).attr("data-posttypes"),u=l(o).attr("data-nofavoritestext");l.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.favoritelist,userid:t,siteid:e,include_links:n,include_buttons:r,include_thumbnails:a,thumbnail_size:i,include_excerpt:s,no_favorites:u,post_types:c},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully retrieved."),console.log(l(o)),console.log(t));var e=l(t.list);l(o).replaceWith(e),f.removeButtonLoading(e),l(document).trigger("favorites-list-updated",[e])},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error updating the list."),console.log(o),console.log(t))}})},f.removeButtonLoading=function(t){var e=l(t).find(Favorites.selectors.button);l.each(e,function(){f.buttonFormatter.format(l(this),!1),l(this).removeClass(Favorites.cssClasses.active),l(this).removeClass(Favorites.cssClasses.loading)})},f.removeInvalidListItems=function(t,n){var e=l(t).find("li[data-postid]");l.each(e,function(t,e){var o=l(this).attr("data-postid");f.utilities.isFavorite(o,n)||l(this).remove()})},f.bindEvents()},(Favorites=Favorites||{}).Button=function(){var e=this,o=jQuery;return e.activeButton,e.allButtons,e.authenticated=!0,e.formatter=new Favorites.Formatter,e.data={},e.bindEvents=function(){o(document).on("click",Favorites.selectors.button,function(t){t.preventDefault(),e.activeButton=o(this),e.setAllButtons(),e.submitFavorite()})},e.setAllButtons=function(){var t=o(e.activeButton).attr("data-postid");e.allButtons=o('button[data-postid="'+t+'"]')},e.setData=function(){e.data.post_id=o(e.activeButton).attr("data-postid"),e.data.site_id=o(e.activeButton).attr("data-siteid"),e.data.status=o(e.activeButton).hasClass("active")?"inactive":"active";var t=o(e.activeButton).attr("data-user-consent-accepted");e.data.user_consent_accepted=void 0!==t&&""!==t},e.submitFavorite=function(){e.setData();e.data.site_id,e.data.user_consent_accepted;var t="active"===e.data.status;if("1"===Favorites.jsData.logged_in)return t?Favorites.UserFavorites().addFavorite(e.data):Favorites.UserFavorites().removeFavorite(e.data);window.location=Favorites.jsData.authentication_redirect_url},e.resetButtons=function(){var t=parseInt(o(e.activeButton).attr("data-favoritecount"));o.each(e.allButtons,function(){if("inactive"===e.data.status)return t<=0&&(t=1),o(this).removeClass(Favorites.cssClasses.active),o(this).attr("data-favoritecount",t-1),void o(this).find(Favorites.selectors.count).text(t-1);o(this).addClass(Favorites.cssClasses.active),o(this).attr("data-favoritecount",t+1),o(this).find(Favorites.selectors.count).text(t+1)})},e.bindEvents(),e},(Favorites=Favorites||{}).ButtonUpdater=function(){var n=this,r=jQuery;return n.utilities=new Favorites.Utilities,n.formatter=new Favorites.Formatter,n.buttonFormatter=new Favorites.ButtonOptionsFormatter,n.activeButton,n.data={},n.bindEvents=function(){r(document).on("favorites-update-all-buttons",function(){n.updateAllButtons()}),r(document).on("favorites-list-updated",function(t,e){n.updateAllButtons(e)})},n.updateAllButtons=function(t){var e=Favorites.UserFavorites().getFavorites(!0),o=r(Favorites.selectors.button);e.then(function(t){for(var e=0;e<r(o).length;e++)n.activeButton=r(o)[e],Favorites.authenticated&&n.setButtonData(t),Favorites.authenticated&&n.utilities.isFavorite(n.data.postid,n.data.site_favorites)?(n.buttonFormatter.format(r(n.activeButton),!0),r(n.activeButton).addClass(Favorites.cssClasses.active)):(console.log("isFavorite"),console.log(n.utilities.isFavorite(n.data.postid,n.data.site_favorites)),console.log(n.data.site_favorites),console.log(n.data.postid),n.buttonFormatter.format(r(n.activeButton),!1),r(n.activeButton).removeClass(Favorites.cssClasses.active)),r(n.activeButton).removeClass(Favorites.cssClasses.loading),r(n.activeButton).find(Favorites.selectors.count).text(n.data.favorite_count)})},n.setButtonData=function(t){n.data.postid=r(n.activeButton).attr("data-postid"),n.data.siteid=r(n.activeButton).attr("data-siteid"),n.data.favorite_count=r(n.activeButton).attr("data-favoritecount"),n.data.site_index=n.utilities.siteIndex(n.data.siteid,t),n.data.site_favorites=t[0].posts,n.data.favorite_count<=0&&(n.data.favorite_count=0)},n.bindEvents()},(Favorites=Favorites||{}).TotalCount=function(){var t=this,e=jQuery;return t.bindEvents=function(){Favorites.jsData.logged_in.length&&(e(window).on("load",function(){t.updateTotal()}),e(document).on("favorites-updated-single",function(){t.updateTotal()}),e(document).on("favorites-cleared",function(){t.updateTotal()}),e(document).one("favorites-user-favorites-loaded",function(){t.updateTotal()}))},t.updateTotal=function(){Favorites.UserFavorites().getFavorites().then(function(t){return e(Favorites.selectors.total_favorites).text(Object.keys(t[0].groups[0].posts).length)})},t.bindEvents()},(Favorites=Favorites||{}).PostFavoriteCount=function(){var a=this,c=jQuery;return a.bindEvents=function(){c(document).on("favorites-updated-single",function(t,e,o,n,r){if("active"===r)return a.updateCounts();a.decrementSingle(o,n)}),c(document).on("favorites-cleared",function(t,e,o){a.updateCounts(o,!0)})},a.updateCounts=function(t,e){void 0!==t&&""!==t||(t=Favorites.userFavorites),void 0!==e&&""!==e||(e=!1);for(var o=0;o<c("["+Favorites.selectors.post_favorite_count+"]").length;o++){var n=c("["+Favorites.selectors.post_favorite_count+"]")[o],r=parseInt(c(n).attr(Favorites.selectors.post_favorite_count)),a=c(n).attr("data-siteid");""===a&&(a="1");for(var i=0;i<t.length;i++){var s=t[i];s.site_id===parseInt(a)&&c.each(s.posts,function(){if(this.post_id===r){if(e){var t=parseInt(this.total)-1;return void c(n).text(t)}c(n).text(this.total)}})}}},a.decrementSingle=function(t,e){for(var o=0;o<c("["+Favorites.selectors.post_favorite_count+"]").length;o++){var n=c("["+Favorites.selectors.post_favorite_count+"]")[o],r=c(n).attr(Favorites.selectors.post_favorite_count),a=c(n).attr("data-siteid");if(""===a&&(a="1"),a===e&&r===t){var i=parseInt(c(n).text())-1;c(n).text(i)}}},a.bindEvents()},(Favorites=Favorites||{}).RequireAuthentication=function(){var e=this,o=jQuery;return e.bindEvents=function(){o(document).on("favorites-require-authentication",function(){Favorites.jsData.dev_mode&&console.log("Unauthenticated user was prevented from favoriting."),Favorites.jsData.authentication_redirect?e.redirect():e.openModal()}),o(document).on("click",".simplefavorites-modal-backdrop",function(t){e.closeModal()}),o(document).on("click","["+Favorites.selectors.close_modals+"]",function(t){t.preventDefault(),e.closeModal()})},e.redirect=function(){window.location=Favorites.jsData.authentication_redirect_url},e.openModal=function(){e.buildModal(),setTimeout(function(){o("["+Favorites.selectors.modals+"]").addClass("active")},10)},e.buildModal=function(){if(!(0<o("["+Favorites.selectors.modals+"]").length)){var t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.modals+"></div>";t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.modals+">",t+='<div class="simplefavorites-modal-content-body">',t+=Favorites.jsData.authentication_modal_content,t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",o("body").prepend(t)}},e.closeModal=function(){o("["+Favorites.selectors.modals+"]").removeClass("active"),o(document).trigger("favorites-modal-closed")},e.bindEvents()},(Favorites=Favorites||{}).RequireConsent=function(){var r=this,o=jQuery;return r.consentData,r.postData,r.activeButton,r.bindEvents=function(){o(document).on("favorites-require-consent",function(t,e,o,n){r.consentData=e,r.postData=o,r.activeButton=n,r.openModal()}),o(document).on("favorites-user-consent-approved",function(t,e){if(void 0!==e)return o(r.activeButton).attr("data-user-consent-accepted","true"),o(r.activeButton).click(),void r.closeModal();r.setConsent(!0)}),o(document).on("favorites-user-consent-denied",function(){r.setConsent(!1)}),o(document).on("click",".simplefavorites-modal-backdrop",function(t){r.closeModal()}),o(document).on("click","[data-favorites-consent-deny]",function(t){t.preventDefault(),r.closeModal(),o(document).trigger("favorites-user-consent-denied")}),o(document).on("click","[data-favorites-consent-accept]",function(t){t.preventDefault(),o(document).trigger("favorites-user-consent-approved",[o(this)])})},r.openModal=function(){r.buildModal(),setTimeout(function(){o("["+Favorites.selectors.consentModal+"]").addClass("active")},10)},r.buildModal=function(){if(!(0<o("["+Favorites.selectors.consentModal+"]").length)){var t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.consentModal+"></div>";t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.consentModal+">",t+='<div class="simplefavorites-modal-content-body no-padding">',t+='<div class="simplefavorites-modal-content-interior">',t+=r.consentData.message,t+="</div>",t+='<div class="simplefavorites-modal-content-footer">',t+='<button class="simplefavorites-button-consent-deny" data-favorites-consent-deny>'+r.consentData.deny_text+"</button>",t+='<button class="simplefavorites-button-consent-accept" data-favorites-consent-accept>'+r.consentData.accept_text+"</button>",t+="</div>\x3c!-- .simplefavorites-modal-footer --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",o("body").prepend(t)}},r.closeModal=function(){o("["+Favorites.selectors.consentModal+"]").removeClass("active")},r.setConsent=function(t){o.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.cookieConsent,consent:t}})},r.bindEvents()},jQuery(document).ready(function(){new Favorites.Factory}),(Favorites=Favorites||{}).selectors={button:".simplefavorite-button",list:".favorites-list",clear_button:".simplefavorites-clear",total_favorites:".simplefavorites-user-count",modals:"data-favorites-modal",consentModal:"data-favorites-consent-modal",close_modals:"data-favorites-modal-close",count:".simplefavorite-button-count",post_favorite_count:"data-favorites-post-count-id"},Favorites.cssClasses={loading:"loading",active:"active"},Favorites.removalCache={},Favorites.jsData={ajaxurl:favorites_data.ajaxurl,restUrl:favorites_data.restUrl,maybeGetUserFavorites:favorites_data.maybeGetUserFavorites,favorite:favorites_data.favorite,favorited:favorites_data.favorited,include_count:favorites_data.includecount,indicate_loading:favorites_data.indicate_loading,loading_text:favorites_data.loading_text,loading_image_active:favorites_data.loading_image_active,loading_image:favorites_data.loading_image,cache_enabled:favorites_data.cache_enabled,authentication_modal_content:favorites_data.authentication_modal_content,authentication_redirect:favorites_data.authentication_redirect,authentication_redirect_url:favorites_data.authentication_redirect_url,button_options:favorites_data.button_options,dev_mode:favorites_data.dev_mode,logged_in:favorites_data.logged_in,user_id:favorites_data.user_id,api_endpoints:{nonce:favorites_data.restUrl+"/generate-nonce",user_favorites:favorites_data.restUrl+"/user-favorites",favorite_button:favorites_data.restUrl+"/favorite-button"}},Favorites.userFavorites=null,Favorites.authenticated=!0,Favorites.store=window.localforage,Favorites.formActions={favoritesarray:"favorites_array",favorite:"favorites_favorite",clearall:"favorites_clear",favoritelist:"favorites_list",cookieConsent:"favorites_cookie_consent"},Favorites.shouldLoad=function(){},Favorites.Factory=function(){jQuery;return this.build=function(){new Favorites.UserFavorites,new Favorites.Sync,new Favorites.Lists,new Favorites.Clear,new Favorites.Button,new Favorites.ButtonUpdater,new Favorites.TotalCount,new Favorites.PostFavoriteCount,new Favorites.RequireAuthentication,new Favorites.RequireConsent},this.build()};