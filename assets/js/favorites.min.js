var Favorites;function favorites_after_button_submit(t,e,a,o){}function favorites_after_initial_load(t){}(Favorites=Favorites||{}).Utilities=function(){var t=this,e=jQuery;t.isFavorite=function(a,t){var o=!1;return e.each(t,function(t,e){e.post_id===parseInt(a)&&(o=!0),parseInt(e.post_id)===a&&(o=!0)}),o},t.objectLength=function(t){var e,a=0;for(e in t)t.hasOwnProperty(e)&&a++;return a},t.siteIndex=function(t){for(var e=0;e<Favorites.userFavorites.length;e++)if(Favorites.userFavorites[e].site_id===parseInt(t))return e},t.getThumbnail=function(t,e){var a=t.thumbnails;if(void 0===a||0==a.length)return!1;var o=a[e];return void 0!==o&&(o||!1)}},(Favorites=Favorites||{}).Formatter=function(){var s=jQuery;this.addFavoriteCount=function(t,e){return Favorites.jsData.button_options.include_count?(e<=0&&(e=0),t+=' <span class="simplefavorite-button-count">'+e+"</span>"):t},this.decrementAllCounts=function(){for(var t=s(".simplefavorite-button.active.has-count"),e=0;e<t.length;e++){var a=s(t)[e],o=s(a).find(".simplefavorite-button-count"),i=s(o).text()-1;s(a).attr("data-favoritecount",i)}}},(Favorites=Favorites||{}).ButtonOptionsFormatter=function(){var s=this,n=jQuery;s.options=Favorites.jsData.button_options,s.formatter=new Favorites.Formatter,s.format=function(t,e){s.options.custom_colors&&s.colors(t,e),s.html(t,e)},s.html=function(t,e){var a=n(t).attr("data-favoritecount"),o=s.options.button_type,i="";return"custom"===s.options.button_type?(e&&n(t).html(s.formatter.addFavoriteCount(Favorites.jsData.favorited,a)),e||n(t).html(s.formatter.addFavoriteCount(Favorites.jsData.favorite,a)),s.applyIconColor(t,e),void s.applyCountColor(t,e)):e?(i+='<i class="'+o.icon_class+'"></i> ',i+=o.state_active,void n(t).html(s.formatter.addFavoriteCount(i,a))):(i+='<i class="'+o.icon_class+'"></i> ',i+=o.state_default,n(t).html(s.formatter.addFavoriteCount(i,a)),s.applyIconColor(t,e),void s.applyCountColor(t,e))},s.colors=function(t,e){if(s.options.custom_colors){var a;if(e)return(a=s.options.active).background_active&&n(t).css("background-color",a.background_active),a.border_active&&n(t).css("border-color",a.border_active),void(a.text_active&&n(t).css("color",a.text_active));(a=s.options.default).background_default&&n(t).css("background-color",a.background_default),a.border_default&&n(t).css("border-color",a.border_default),a.text_default&&n(t).css("color",a.text_default),s.boxShadow(t)}},s.boxShadow=function(t){s.options.box_shadow||(n(t).css("box-shadow","none"),n(t).css("-webkit-box-shadow","none"),n(t).css("-moz-box-shadow","none"))},s.applyIconColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.icon_active&&n(t).find("i").css("color",s.options.active.icon_active),!e&&s.options.default.icon_default&&n(t).find("i").css("color",s.options.default.icon_default))},s.applyCountColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.count_active?n(t).find(Favorites.selectors.count).css("color",s.options.active.count_active):!e&&s.options.default.count_default&&n(t).find(Favorites.selectors.count).css("color",s.options.default.count_default))}},(Favorites=Favorites||{}).UserFavorites=function(){var e=this,a=jQuery;return e.initialLoad=!1,e.bindEvents=function(){a(window).on("load",function(){e.initialLoad=!0,e.getFavorites()})},e.getFavorites=function(){Favorites.jsData.maybeGetUserFavorites&&a.get({url:Favorites.jsData.api_endpoints.user_favorites,datatype:"json",success:function(t){Favorites.jsData.dev_mode&&(console.log("The current user favorites were successfully loaded."),console.log(t)),Favorites.userFavorites=t.favorites,a(document).trigger("favorites-user-favorites-loaded",[t.favorites,e.initialLoad]),a(document).trigger("favorites-update-all-buttons"),e.initialLoad&&favorites_after_initial_load(Favorites.userFavorites)},error:function(t){Favorites.jsData.dev_mode&&(console.log("The was an error loading the user favorites."),console.log(t))}})},e.bindEvents()},(Favorites=Favorites||{}).Clear=function(){var i=this,s=jQuery;return i.activeButton,i.utilities=new Favorites.Utilities,i.formatter=new Favorites.Formatter,i.bindEvents=function(){s(document).on("click",Favorites.selectors.clear_button,function(t){t.preventDefault(),i.activeButton=s(this),i.clearFavorites()}),s(document).on("favorites-updated-single",function(){i.updateClearButtons()}),s(document).on("favorites-user-favorites-loaded",function(){i.updateClearButtons()})},i.clearFavorites=function(){i.loading(!0);var e=s(i.activeButton).attr("data-siteid");s.ajax({url:Favorites.jsData.ajaxurl,type:"post",datatype:"json",data:{action:Favorites.formActions.clearall,siteid:e},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully cleared."),console.log(t)),Favorites.userFavorites=t.favorites,i.formatter.decrementAllCounts(),i.loading(!1),i.clearSiteFavorites(e),s(document).trigger("favorites-cleared",[i.activeButton,t.old_favorites]),s(document).trigger("favorites-update-all-buttons")},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error clearing the favorites list."),console.log(t))}})},i.loading=function(t){if(t)return s(i.activeButton).addClass(Favorites.cssClasses.loading),void s(i.activeButton).attr("disabled","disabled");s(i.activeButton).removeClass(Favorites.cssClasses.loading)},i.updateClearButtons=function(){for(var t,e,a=0;a<s(Favorites.selectors.clear_button).length;a++){t=s(Favorites.selectors.clear_button)[a],e=s(t).attr("data-siteid");for(var o=0;o<Favorites.userFavorites.length;o++)Favorites.userFavorites[o].site_id===parseInt(e)&&(0<i.utilities.objectLength(Favorites.userFavorites[o].posts)?s(t).attr("disabled",!1):s(t).attr("disabled","disabled"))}},i.clearSiteFavorites=function(a){s.each(Favorites.userFavorites,function(t,e){this.site_id===parseInt(a)&&(Favorites.userFavorites[t].posts={})})},i.bindEvents()},(Favorites=Favorites||{}).Lists=function(){var u=this,v=jQuery;return u.utilities=new Favorites.Utilities,u.buttonFormatter=new Favorites.ButtonOptionsFormatter,u.bindEvents=function(){v(document).on("favorites-update-all-lists",function(){u.updateAllLists()}),v(document).on("favorites-updated-single",function(){u.updateAllLists()}),v(document).on("favorites-cleared",function(){u.updateAllLists()}),v(document).on("favorites-user-favorites-loaded",function(){u.updateAllLists()})},u.updateAllLists=function(){if(void 0!==Favorites.userFavorites)for(var t=0;t<Favorites.userFavorites.length;t++)for(var e=v(Favorites.selectors.list+'[data-siteid="'+Favorites.userFavorites[t].site_id+'"]'),a=0;a<v(e).length;a++){var o=v(e)[a];u.updateSingleList(o)}},u.updateSingleList=function(a){var t=v(a).attr("data-userid"),e=v(a).attr("data-siteid"),o=v(a).attr("data-includelinks"),i=v(a).attr("data-includebuttons"),s=v(a).attr("data-includethumbnails"),n=v(a).attr("data-thumbnailsize"),r=v(a).attr("data-includeexcerpts"),c=v(a).attr("data-posttypes"),d=v(a).attr("data-nofavoritestext");v.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.favoritelist,userid:t,siteid:e,include_links:o,include_buttons:i,include_thumbnails:s,thumbnail_size:n,include_excerpt:r,no_favorites:d,post_types:c},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully retrieved."),console.log(v(a)),console.log(t));var e=v(t.list);v(a).replaceWith(e),u.removeButtonLoading(e),v(document).trigger("favorites-list-updated",[e])},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error updating the list."),console.log(a),console.log(t))}})},u.removeButtonLoading=function(t){var e=v(t).find(Favorites.selectors.button);v.each(e,function(){u.buttonFormatter.format(v(this),!1),v(this).removeClass(Favorites.cssClasses.active),v(this).removeClass(Favorites.cssClasses.loading)})},u.removeInvalidListItems=function(t,o){var e=v(t).find("li[data-postid]");v.each(e,function(t,e){var a=v(this).attr("data-postid");u.utilities.isFavorite(a,o)||v(this).remove()})},u.bindEvents()},(Favorites=Favorites||{}).Button=function(){var a=this,o=jQuery;return a.activeButton,a.allButtons,a.authenticated=!0,a.formatter=new Favorites.Formatter,a.data={},a.bindEvents=function(){o(document).on("click",Favorites.selectors.button,function(t){t.preventDefault(),a.activeButton=o(this),a.setAllButtons(),a.submitFavorite()})},a.setAllButtons=function(){var t=o(a.activeButton).attr("data-postid");a.allButtons=o('button[data-postid="'+t+'"]')},a.setData=function(){a.data.post_id=o(a.activeButton).attr("data-postid"),a.data.site_id=o(a.activeButton).attr("data-siteid"),a.data.status=o(a.activeButton).hasClass("active")?"inactive":"active";var t=o(a.activeButton).attr("data-user-consent-accepted");a.data.user_consent_accepted=void 0!==t&&""!==t},a.submitFavorite=function(){a.loading(!0),a.setData();var t={siteid:a.data.site_id,user_consent_accepted:a.data.user_consent_accepted},e="active"===a.data.status?"POST":"DELETE";o.ajax({url:Favorites.jsData.api_endpoints.user_favorites+"/"+a.data.post_id,type:e,dataType:"json",data:t,success:function(t){return Favorites.jsData.dev_mode&&(console.log("The favorite was successfully saved."),console.log(t)),"unauthenticated"===t.status?(Favorites.authenticated=!1,a.loading(!1),a.data.status="inactive",o(document).trigger("favorites-update-all-buttons"),void o(document).trigger("favorites-require-authentication",[a.data])):"consent_required"===t.status?(a.loading(!1),void o(document).trigger("favorites-require-consent",[t,a.data,a.activeButton])):(Favorites.userFavorites=t.favorites,a.loading(!1),a.resetButtons(),o(document).trigger("favorites-updated-single",[t.favorites,a.data.post_id,a.data.site_id,a.data.status]),o(document).trigger("favorites-update-all-buttons"),void favorites_after_button_submit(t.favorites,a.data.post_id,a.data.site_id,a.data.status))},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error saving the favorite."),console.log(t))}})},a.resetButtons=function(){var t=parseInt(o(a.activeButton).attr("data-favoritecount"));o.each(a.allButtons,function(){if("inactive"===a.data.status)return t<=0&&(t=1),o(this).removeClass(Favorites.cssClasses.active),o(this).attr("data-favoritecount",t-1),void o(this).find(Favorites.selectors.count).text(t-1);o(this).addClass(Favorites.cssClasses.active),o(this).attr("data-favoritecount",t+1),o(this).find(Favorites.selectors.count).text(t+1)})},a.loading=function(t){t?o.each(a.allButtons,function(){o(this).attr("disabled","disabled"),o(this).addClass(Favorites.cssClasses.loading),o(this).html(a.addLoadingIndication())}):o.each(a.allButtons,function(){o(this).attr("disabled",!1),o(this).removeClass(Favorites.cssClasses.loading)})},a.addLoadingIndication=function(t){return"1"!==Favorites.jsData.indicate_loading?t:"active"===a.data.status?Favorites.jsData.loading_text+Favorites.jsData.loading_image_active:Favorites.jsData.loading_text+Favorites.jsData.loading_image},a.bindEvents()},(Favorites=Favorites||{}).ButtonUpdater=function(){var o=this,i=jQuery;return o.utilities=new Favorites.Utilities,o.formatter=new Favorites.Formatter,o.buttonFormatter=new Favorites.ButtonOptionsFormatter,o.activeButton,o.data={},o.bindEvents=function(){i(document).on("favorites-update-all-buttons",function(){o.updateAllButtons()}),i(document).on("favorites-list-updated",function(t,e){o.updateAllButtons(e)})},o.updateAllButtons=function(t){if(void 0!==Favorites.userFavorites)for(var e=i(Favorites.selectors.button),a=0;a<i(e).length;a++)o.activeButton=i(e)[a],Favorites.authenticated&&o.setButtonData(),Favorites.authenticated&&o.utilities.isFavorite(o.data.postid,o.data.site_favorites)?(o.buttonFormatter.format(i(o.activeButton),!0),i(o.activeButton).addClass(Favorites.cssClasses.active)):(o.buttonFormatter.format(i(o.activeButton),!1),i(o.activeButton).removeClass(Favorites.cssClasses.active)),i(o.activeButton).removeClass(Favorites.cssClasses.loading),i(o.activeButton).find(Favorites.selectors.count).text(o.data.favorite_count)},o.setButtonData=function(){o.data.postid=i(o.activeButton).attr("data-postid"),o.data.siteid=i(o.activeButton).attr("data-siteid"),o.data.favorite_count=i(o.activeButton).attr("data-favoritecount"),o.data.site_index=o.utilities.siteIndex(o.data.siteid),o.data.site_favorites=Favorites.userFavorites[o.data.site_index].posts,o.data.favorite_count<=0&&(o.data.favorite_count=0)},o.bindEvents()},(Favorites=Favorites||{}).TotalCount=function(){var t=this,r=jQuery;return t.bindEvents=function(){r(document).on("favorites-updated-single",function(){t.updateTotal()}),r(document).on("favorites-cleared",function(){t.updateTotal()}),r(document).on("favorites-user-favorites-loaded",function(){t.updateTotal()})},t.updateTotal=function(){for(var t=0;t<r(Favorites.selectors.total_favorites).length;t++){for(var e=r(Favorites.selectors.total_favorites)[t],a=parseInt(r(e).attr("data-siteid")),o=r(e).attr("data-posttypes").split(","),i=0,s=0;s<Favorites.userFavorites.length;s++){var n=Favorites.userFavorites[s];n.site_id===a&&r.each(n.posts,function(){"all"!==r(e).attr("data-posttypes")?-1!==r.inArray(this.post_type,o)&&i++:i++})}r(e).text(i)}},t.bindEvents()},(Favorites=Favorites||{}).PostFavoriteCount=function(){var s=this,c=jQuery;return s.bindEvents=function(){c(document).on("favorites-updated-single",function(t,e,a,o,i){if("active"===i)return s.updateCounts();s.decrementSingle(a,o)}),c(document).on("favorites-cleared",function(t,e,a){s.updateCounts(a,!0)})},s.updateCounts=function(t,e){void 0!==t&&""!==t||(t=Favorites.userFavorites),void 0!==e&&""!==e||(e=!1);for(var a=0;a<c("["+Favorites.selectors.post_favorite_count+"]").length;a++){var o=c("["+Favorites.selectors.post_favorite_count+"]")[a],i=parseInt(c(o).attr(Favorites.selectors.post_favorite_count)),s=c(o).attr("data-siteid");""===s&&(s="1");for(var n=0;n<t.length;n++){var r=t[n];r.site_id===parseInt(s)&&c.each(r.posts,function(){if(this.post_id===i){if(e){var t=parseInt(this.total)-1;return void c(o).text(t)}c(o).text(this.total)}})}}},s.decrementSingle=function(t,e){for(var a=0;a<c("["+Favorites.selectors.post_favorite_count+"]").length;a++){var o=c("["+Favorites.selectors.post_favorite_count+"]")[a],i=c(o).attr(Favorites.selectors.post_favorite_count),s=c(o).attr("data-siteid");if(""===s&&(s="1"),s===e&&i===t){var n=parseInt(c(o).text())-1;c(o).text(n)}}},s.bindEvents()},(Favorites=Favorites||{}).RequireAuthentication=function(){var e=this,a=jQuery;return e.bindEvents=function(){a(document).on("favorites-require-authentication",function(){Favorites.jsData.dev_mode&&console.log("Unauthenticated user was prevented from favoriting."),Favorites.jsData.authentication_redirect?e.redirect():e.openModal()}),a(document).on("click",".simplefavorites-modal-backdrop",function(t){e.closeModal()}),a(document).on("click","["+Favorites.selectors.close_modals+"]",function(t){t.preventDefault(),e.closeModal()})},e.redirect=function(){window.location=Favorites.jsData.authentication_redirect_url},e.openModal=function(){e.buildModal(),setTimeout(function(){a("["+Favorites.selectors.modals+"]").addClass("active")},10)},e.buildModal=function(){if(!(0<a("["+Favorites.selectors.modals+"]").length)){var t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.modals+"></div>";t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.modals+">",t+='<div class="simplefavorites-modal-content-body">',t+=Favorites.jsData.authentication_modal_content,t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",a("body").prepend(t)}},e.closeModal=function(){a("["+Favorites.selectors.modals+"]").removeClass("active"),a(document).trigger("favorites-modal-closed")},e.bindEvents()},(Favorites=Favorites||{}).RequireConsent=function(){var i=this,a=jQuery;return i.consentData,i.postData,i.activeButton,i.bindEvents=function(){a(document).on("favorites-require-consent",function(t,e,a,o){i.consentData=e,i.postData=a,i.activeButton=o,i.openModal()}),a(document).on("favorites-user-consent-approved",function(t,e){if(void 0!==e)return a(i.activeButton).attr("data-user-consent-accepted","true"),a(i.activeButton).click(),void i.closeModal();i.setConsent(!0)}),a(document).on("favorites-user-consent-denied",function(){i.setConsent(!1)}),a(document).on("click",".simplefavorites-modal-backdrop",function(t){i.closeModal()}),a(document).on("click","[data-favorites-consent-deny]",function(t){t.preventDefault(),i.closeModal(),a(document).trigger("favorites-user-consent-denied")}),a(document).on("click","[data-favorites-consent-accept]",function(t){t.preventDefault(),a(document).trigger("favorites-user-consent-approved",[a(this)])})},i.openModal=function(){i.buildModal(),setTimeout(function(){a("["+Favorites.selectors.consentModal+"]").addClass("active")},10)},i.buildModal=function(){if(!(0<a("["+Favorites.selectors.consentModal+"]").length)){var t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.consentModal+"></div>";t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.consentModal+">",t+='<div class="simplefavorites-modal-content-body no-padding">',t+='<div class="simplefavorites-modal-content-interior">',t+=i.consentData.message,t+="</div>",t+='<div class="simplefavorites-modal-content-footer">',t+='<button class="simplefavorites-button-consent-deny" data-favorites-consent-deny>'+i.consentData.deny_text+"</button>",t+='<button class="simplefavorites-button-consent-accept" data-favorites-consent-accept>'+i.consentData.accept_text+"</button>",t+="</div>\x3c!-- .simplefavorites-modal-footer --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",a("body").prepend(t)}},i.closeModal=function(){a("["+Favorites.selectors.consentModal+"]").removeClass("active")},i.setConsent=function(t){a.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.cookieConsent,consent:t}})},i.bindEvents()},jQuery(document).ready(function(){new Favorites.Factory}),(Favorites=Favorites||{}).selectors={button:".simplefavorite-button",list:".favorites-list",clear_button:".simplefavorites-clear",total_favorites:".simplefavorites-user-count",modals:"data-favorites-modal",consentModal:"data-favorites-consent-modal",close_modals:"data-favorites-modal-close",count:".simplefavorite-button-count",post_favorite_count:"data-favorites-post-count-id"},Favorites.cssClasses={loading:"loading",active:"active"},Favorites.jsData={ajaxurl:favorites_data.ajaxurl,restUrl:favorites_data.rest_url,maybeGetUserFavorites:favorites_data.maybeGetUserFavorites,favorite:favorites_data.favorite,favorited:favorites_data.favorited,include_count:favorites_data.includecount,indicate_loading:favorites_data.indicate_loading,loading_text:favorites_data.loading_text,loading_image_active:favorites_data.loading_image_active,loading_image:favorites_data.loading_image,cache_enabled:favorites_data.cache_enabled,authentication_modal_content:favorites_data.authentication_modal_content,authentication_redirect:favorites_data.authentication_redirect,authentication_redirect_url:favorites_data.authentication_redirect_url,button_options:favorites_data.button_options,dev_mode:favorites_data.dev_mode,logged_in:favorites_data.logged_in,user_id:favorites_data.user_id},Favorites.jsData.api_endpoints={nonce:Favorites.jsData.restUrl+"/generate-nonce",user_favorites:Favorites.jsData.restUrl+"/user-favorites",favorite_button:Favorites.jsData.restUrl+"/favorite-button"},Favorites.userFavorites=null,Favorites.authenticated=!0,Favorites.formActions={favoritesarray:"favorites_array",favorite:"favorites_favorite",clearall:"favorites_clear",favoritelist:"favorites_list",cookieConsent:"favorites_cookie_consent"},Favorites.Factory=function(){jQuery;return this.build=function(){new Favorites.UserFavorites,new Favorites.Lists,new Favorites.Clear,new Favorites.Button,new Favorites.ButtonUpdater,new Favorites.TotalCount,new Favorites.PostFavoriteCount,new Favorites.RequireAuthentication,new Favorites.RequireConsent},this.build()};